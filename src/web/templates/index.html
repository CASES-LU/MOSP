{% extends "layout.html" %}
{% block content %}
<div class="container-fluid">
    <div class="row">
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col">
            <h4>Recently updated schemas</h4>
            <div id="list-schemas"></div>
        </div>
        <div class="col">
            <h4>Recently updated objects</h4>
        </div>
    </div>
</div><!-- /.container -->
<script>
$(document).ready(function() {
    $.ajax({ // Get the list of projects
        url: "{{ url_for('schemaapi0.schemaapi',) }}",
        dataType: "json",
        contentType: "application/json",
        success: function(schemas) {
            schemas.objects
            .sort(function (a, b) {
                return a.last_updated < b.last_updated;
            })
            .map(function (schema) {
                var cardHTML = schemaHomeTemplate({
                    'project_url': '/schema/'+schema.id,
                    'project_name': schema.name,
                    'project_description': schema.description,
                    'organization': schema.organization.name,
                    'project_last_update': moment(schema.last_updated).fromNow()
                 });
                 $('#list-schemas').append(cardHTML);
            });
        }
    });
});
</script>
{% endblock %}
